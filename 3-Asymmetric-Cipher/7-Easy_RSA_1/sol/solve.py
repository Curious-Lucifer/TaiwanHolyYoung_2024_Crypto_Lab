import requests
from Crypto.Util.number import long_to_bytes


def factordb(n: int):
    factordb_api_url = 'http://factordb.com/api'
    resp = requests.get(factordb_api_url, params = { 'query': n })
    resp.raise_for_status()

    factors = [[int(factor)] * power for factor, power in resp.json()['factors']]
    factors = sum(factors, [])
    return factors


n = 558098643612442982869412022469246232193159102034581572625352272974227508724473952162960296832221266344918324209865053779262023996763482052514433441095525096832124022399320433830134804734321051616877085252534068802372830522359759248304816981536234329416042954494512044857893369730186700141160304115005148441761425180202201733261896417588308517257278921240631686899602960449771608786644313798116795435002176570933880511306119378180015212643414069934184998512031405143417
e = 65537
c = 516159413447458442301604958221763534692609641988597871082605764283823956573795619128264278802865129137415684054075645301940202655838462944593710475306765753445494124622433361044097665307358761301082095390555467396319971408496508662769321921809765119753151071758945708372163145352828897339448061094186267610588750722986326168345483999990218154775909728920834392462419411374276336477276222786342486282130486976724901696575277929058329049260487708653226358970107854753057


factor_list = factordb(n)
factor_list = [(factor, factor_list.count(factor)) for factor in set(factor_list)]
phin = 1
for factor, exp in factor_list:
    phin *= factor - 1
    phin *= factor ** (exp - 1)
d = pow(e, -1, phin)
m = pow(c, d, n)

print(long_to_bytes(m))
